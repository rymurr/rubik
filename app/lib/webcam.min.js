"use strict";!function(){navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.hasUserMedia=function(){return navigator.getMedia?!0:!1}}(),angular.module("webcam",[]).directive("webcam",function(){return{template:'<div class="webcam" ng-transclude></div>',restrict:"E",replace:!0,transclude:!0,scope:{onError:"&",onStream:"&",onStreaming:"&",placeholder:"="},link:function(a,b){var c=function(b){if(navigator.mozGetUserMedia)e.mozSrcObject=b;else{var c=window.URL||window.webkitURL;e.src=c.createObjectURL(b)}e.play(),a.onStream&&a.onStream({stream:b,video:e})},d=function(b){g(),console&&console.log&&console.log("The following error occured: ",b),a.onError&&a.onError({err:b})},e=document.createElement("video");if(e.setAttribute("class","webcam-live"),e.setAttribute("autoplay",""),b.append(e),a.placeholder){var f=document.createElement("img");f.class="webcam-loader",f.src=a.placeholder,b.append(f)}var g=function(){f&&f.remove()},h=!1,i=b.width=320,j=b.height=0;return window.hasUserMedia()?(navigator.getMedia({video:!0,audio:!1},c,d),e.addEventListener("canplay",function(){h||(j=e.videoHeight/(e.videoWidth/i)||250,e.setAttribute("width",i),e.setAttribute("height",j),h=!0,g(),a.onStreaming&&a.onStreaming({video:e}))},!1),void 0):(d({code:-1,msg:"Browser does not support getUserMedia."}),void 0)}}});